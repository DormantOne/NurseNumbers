<!DOCTYPE html>
<html>
<head>
  <title>Select Nurses and Phone Numbers</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getDatabase, ref, set, get } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyCYDVebdIbJ7DV_tkqvl6dXacP2gd-V6zo",
  authDomain: "nurse-numbers.firebaseapp.com",
  databaseURL: "https://nurse-numbers-default-rtdb.firebaseio.com",
  projectId: "nurse-numbers",
  storageBucket: "nurse-numbers.appspot.com",
  messagingSenderId: "316071093036",
  appId: "1:316071093036:web:233a3bf23d007bb0a2c289",
  measurementId: "G-RW2RPJS2GC"
};

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    window.submitSelection = async function() {
      const selectedNurses = [];
      const selectedNumbers = [];
      const nurseNumberLinks = {};
      for (let i = 0; i < 10; i++) {
        const nurseCheckbox = document.getElementById('nurse' + i);
        const numberCheckbox = document.getElementById('number' + i);
        if (nurseCheckbox.checked) {
          selectedNurses.push(nurseCheckbox.value);
          const dropdown = document.getElementById('dropdown' + i);
          nurseNumberLinks[nurseCheckbox.value] = dropdown.value;
        }
        if (numberCheckbox.checked) {
          selectedNumbers.push(numberCheckbox.value);
        }
      }

      const timestamp = new Date().toLocaleString();
      const data = {
        selectedNurses,
        selectedNumbers,
        nurseNumberLinks,
        timestamp
      };

      await set(ref(db, '/selections'), data);

      const selectedDiv = document.getElementById('selected');
      selectedDiv.innerHTML = `
        <p>Selected Nurses: ${selectedNurses.join(', ')}</p>
        <p>Selected Numbers: ${selectedNumbers.join(', ')}</p>
        <p>Nurse-Number Links: ${JSON.stringify(nurseNumberLinks)}</p>
        <p>Timestamp: ${timestamp}</p>
      `;
    }

    window.onload = async function() {
      const snapshot = await get(ref(db, '/selections'));
      if (snapshot.exists()) {
        const data = snapshot.val();
        data.selectedNurses.forEach(nurse => {
          const index = nurses.indexOf(nurse);
          if (index > -1) {
            document.getElementById('nurse' + index).checked = true;
            const dropdown = document.getElementById('dropdown' + index);
            dropdown.value = data.nurseNumberLinks[nurse];
          }
        });
        data.selectedNumbers.forEach(number => {
          const index = numbers.indexOf(number);
          if (index > -1) {
            document.getElementById('number' + index).checked = true;
          }
        });

        const selectedDiv = document.getElementById('selected');
        selectedDiv.innerHTML = `
          <p>Selected Nurses: ${data.selectedNurses.join(', ')}</p>
          <p>Selected Numbers: ${data.selectedNumbers.join(', ')}</p>
          <p>Nurse-Number Links: ${JSON.stringify(data.nurseNumberLinks)}</p>
          <p>Timestamp: ${data.timestamp}</p>
        `;
      }
    }
  </script>
</head>
<body>
  <h2>Select Nurses:</h2>
  <div id="nurseSelection"></div>

  <h2>Select Phone Numbers:</h2>
  <div id="numberSelection"></div>

  <h2>Link Nurses to Numbers:</h2>
  <div id="linkSelection"></div>

  <button type="button" onclick="submitSelection()">Submit</button>

  <h2>Selected:</h2>
  <div id="selected"></div>

  <script>
const nurses = ['Nurse 1', 'Nurse 2', 'Nurse 3', 'Nurse 4', 'Nurse 5', 'Nurse 6', 'Nurse 7', 'Nurse 8', 'Nurse 9', 'Nurse 10'];
    const numbers = ['Number 1', 'Number 2', 'Number 3', 'Number 4', 'Number 5', 'Number 6', 'Number 7', 'Number 8', 'Number 9', 'Number 10'];

    const nurseSelection = document.getElementById('nurseSelection');
    const numberSelection = document.getElementById('numberSelection');
    const linkSelection = document.getElementById('linkSelection');

    nurses.forEach((nurse, index) => {
      nurseSelection.innerHTML += `
        <div>
          <input type="checkbox" id="nurse${index}" name="nurse" value="${nurse}">
          <label for="nurse${index}">${nurse}</label>
        </div>
      `;
    });

    numbers.forEach((number, index) => {
      numberSelection.innerHTML += `
        <div>
          <input type="checkbox" id="number${index}" name="number" value="${number}">
          <label for="number${index}">${number}</label>
        </div>
      `;
    });

    nurses.forEach((nurse, index) => {
      linkSelection.innerHTML += `
        <div>
          <label for="dropdown${index}">${nurse}</label>
          <select id="dropdown${index}">
            <option value="">Select Number</option>
            ${numbers.map(number => `<option value="${number}">${number}</option>`).join('')}
          </select>
        </div>
      `;
    });
  </script>
</body>
</html>
