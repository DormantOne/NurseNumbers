<!DOCTYPE html>
<html>
<head>
  <title>Select Nurses</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getDatabase, ref, set, get } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCYDVebdIbJ7DV_tkqvl6dXacP2gd-V6zo",
      authDomain: "nurse-numbers.firebaseapp.com",
      databaseURL: "https://nurse-numbers-default-rtdb.firebaseio.com",
      projectId: "nurse-numbers",
      storageBucket: "nurse-numbers.appspot.com",
      messagingSenderId: "316071093036",
      appId: "1:316071093036:web:233a3bf23d007bb0a2c289",
      measurementId: "G-RW2RPJS2GC"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    window.submitSelection = function() {
      const selectedNurses = [];
      for (let i = 0; i < 10; i++) {
        const checkbox = document.getElementById('nurse' + i);
        if (checkbox.checked) {
          selectedNurses.push(checkbox.value);
        }
      }

      const timestamp = new Date().toLocaleString();
      const data = {
        selectedNurses,
        timestamp
      };

      set(ref(db, '/selectedNurses'), data);

      const selectedNursesDiv = document.getElementById('selectedNurses');
      selectedNursesDiv.innerHTML = `
        <p>Selected Nurses: ${selectedNurses.join(', ')}</p>
        <p>Timestamp: ${timestamp}</p>
      `;
    }

    // Load saved data on page load
    window.onload = async function() {
      const snapshot = await get(ref(db, '/selectedNurses'));
      if (snapshot.exists()) {
        const data = snapshot.val();
        data.selectedNurses.forEach(nurse => {
          const index = nurses.indexOf(nurse);
          if (index > -1) {
            document.getElementById('nurse' + index).checked = true;
          }
        });
      }
    }
  </script>
</head>
<body>
  <h2>Select Nurses:</h2>
  <form id="nurseForm">
    <div id="nurseSelection"></div>
    <button type="button" onclick="submitSelection()">Submit</button>
  </form>

  <h2>Selected Nurses:</h2>
  <div id="selectedNurses"></div>

  <script>
    const nurses = ['Nurse 1', 'Nurse 2', 'Nurse 3', 'Nurse 4', 'Nurse 5', 'Nurse 6', 'Nurse 7', 'Nurse 8', 'Nurse 9', 'Nurse 10'];
    const nurseSelection = document.getElementById('nurseSelection');

    nurses.forEach((nurse, index) => {
      nurseSelection.innerHTML += `
        <div>
          <input type="checkbox" id="nurse${index}" name="nurse" value="${nurse}">
          <label for="nurse${index}">${nurse}</label>
        </div>
      `;
    });
  </script>
</body>
</html>
