<!DOCTYPE html>
<html>
<head>
  <title>Select Nurses</title>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
    import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyCYDVebdIbJ7DV_tkqvl6dXacP2gd-V6zo",
  authDomain: "nurse-numbers.firebaseapp.com",
  databaseURL: "https://nurse-numbers-default-rtdb.firebaseio.com",
  projectId: "nurse-numbers",
  storageBucket: "nurse-numbers.appspot.com",
  messagingSenderId: "316071093036",
  appId: "1:316071093036:web:233a3bf23d007bb0a2c289",
  measurementId: "G-RW2RPJS2GC"
};


    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    let selectedNurses = [];
    let selectedNumbers = [];
    let nurseNumberLinks = {};

    window.submitSelection = function() {
      const data = {
        selectedNurses,
        selectedNumbers,
        timestamp: new Date().toLocaleString()
      };

      set(ref(db, '/selection'), data);

      updateLinkSection();
    }

    window.submitLinks = function() {
      const data = {
        nurseNumberLinks,
        timestamp: new Date().toLocaleString()
      };

      set(ref(db, '/links'), data);
    }

    function updateLinkSection() {
      const linkSelection = document.getElementById('linkSelection');
      linkSelection.innerHTML = '';

      selectedNurses.forEach(nurse => {
        linkSelection.innerHTML += `
          <div>
            <label for="${nurse}">${nurse}</label>
            <select id="${nurse}" name="${nurse}" onchange="nurseNumberLinks['${nurse}'] = this.value;">
              ${selectedNumbers.map(number => `<option value="${number}" ${nurseNumberLinks[nurse] === number ? 'selected' : ''}>${number}</option>`).join('')}
            </select>
          </div>
        `;
      });
    }

    window.onload = function() {
      onValue(ref(db, '/selection'), snapshot => {
        const data = snapshot.val();

        if (data) {
          selectedNurses = data.selectedNurses;
          selectedNumbers = data.selectedNumbers;

          selectedNurses.forEach((nurse, index) => {
            document.getElementById('nurse' + index).checked = true;
          });

          selectedNumbers.forEach((number, index) => {
            document.getElementById('number' + index).checked = true;
          });

          updateLinkSection();
        }
      });

      onValue(ref(db, '/links'), snapshot => {
        const data = snapshot.val();

        if (data) {
          nurseNumberLinks = data.nurseNumberLinks;

          for (let nurse in nurseNumberLinks) {
            document.getElementById(nurse).value = nurseNumberLinks[nurse];
          }
        }
      });
    }
  </script>
</head>
<body>
  <h2>Select Nurses:</h2>
  <form id="nurseForm">
    <div id="nurseSelection"></div>
    <button type="button" onclick="submitSelection()">Submit Selection</button>
  </form>

  <h2>Select Phone Numbers:</h2>
  <form id="numberForm">
    <div id="numberSelection"></div>
    <button type="button" onclick="submitSelection()">Submit Selection</button>
  </form>

  <h2>Link Nurses to Numbers:</h2quote("const app = initializeApp(firebaseConfig);\n    const db", "document.getElementById(nurse).value = nurseNumberLinks[nurse];\n          }\n        }\n      });\n    }\n  </script>")
  <form id="linkForm">
    <div id="linkSelection"></div>
    <button type="button" onclick="submitLinks()">Submit Links</button>
  </form>
</body>
</html>
